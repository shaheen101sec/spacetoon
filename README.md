# تقرير شامل عن الأخطاء والثغرات الأمنية في المواقع

## المقدمة

السلام عليكم ورحمة الله وبركاته،

أنا شاهين أمجد، عمري 16 عامًا. لقد فكرت في تقديم هدية بسيطة جدًا لكم تقديرًا للذكريات والعبر الجميلة التي قدمتموها لنا. حتى في عمري هذا، لا زلت أحن للمسلسلات الكرتونية والأنمي القديم مثل "القناص" في جزئه الأول.

الهدية التي أقدمها هي عبارة عن فصل شامل قمت به بكل مهاراتي لفحص مواقعكم على الإنترنت كوسيلة شكر لكم ولحماية مواقعكم من الهجمات التي يمكن أن تسبب ضررًا كبيرًا.

### الملاحظات
منذ الصغر كان هذا حلمي وقد تحقق بفضل الله. التالي هو تقرير شامل عن كل ما فحصته والثغرات التي وجدتها. أتمنى أن أكون قد شرحت بطريقة واضحة ومفهومة لكم. ❤️

---

## الثغرات المكتشفة

### 1. ملفات أرشفت في webarchive.org

عُثر على ملفات تحتوي على ملفات PHP ضارة (c99shell) في الماضي ضمن الموقع الأساسي spacetoon.com. قد تم زرعها سابقًا وكانت تتيح التحكم بالموقع وقاعدة البيانات.

#### الروابط التي كانت تحتوي على الملفات الضارة:
- [رابط 1](https://web.archive.org/web/20140623035444*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399881053461.php)
- [رابط 2](https://web.archive.org/web/20140623044436*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399883407116.php)
- [رابط 3](https://web.archive.org/web/20140623050300*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399882361461.php)

> **ملاحظة:** رغم أن المسار لم يعد موجودًا حاليًا، يجب التأكد من أن المخترق لم يقم بتحويله إلى مسار آخر لضمان عدم حدوث اختراقات مستقبلية.

---

### 2. خطأ تسجيل الدخول باستخدام OAuth

عند محاولة تسجيل الدخول باستخدام Google وFacebook يحدث خطأ "400".

#### التوصيات:
- يرجى إعلامي إذا تم إصلاح الخطأ لأن ذلك سيؤدي إلى إنتاج ملفات تعريف ارتباط جديدة (JWT) قد تحتوي على ثغرات أمنية.

---

### 3. ثغرة Clickjacking

#### التفاصيل:
- هذه الثغرة تجعل المستخدم يضغط على أزرار مخفية دون علمه.
- ليست هناك خطورة كبيرة حاليًا لأنها تؤدي فقط إلى تسجيل خروج المستخدم.

#### الرابط المتأثر:
- [blog.spacetoon.com](https://blog.spacetoon.com)

#### التوصيات:
- التأكد من حماية الصفحات التي تحتوي على أزرار حساسة مثل حذف الحساب.

---

### 4. ثغرة File Upload

#### التفاصيل:
- في [إضافة المقالات](https://blog.spacetoon.com/usercp/artical/add)، يمكن رفع ملفات ضارة مثل .html و.php مما يسمح بالتحكم الكامل بالموقع.

#### التوصيات:
- تحديد أنواع الملفات المسموح برفعها.

---

### 5. ثغرة تسجيل الخروج

#### الرابط:
- [تسجيل الخروج](https://blog.spacetoon.com/logout)

#### المشكلة:
- يمكن استغلال الرابط لجعل المستخدمين يسجلون الخروج دون علمهم.

#### التوصيات:
- إضافة تأكيد قبل تسجيل الخروج.

---

### 6. خطأ استعادة الحساب

#### التفاصيل:
- عند محاولة استعادة كلمة المرور، العملية تتوقف دون سبب.

---

### 7. ضعف حماية DDOS

#### الموقع المتأثر:
- [moshayafamily.spacetoon.com](https://moshayafamily.spacetoon.com)

#### التوصيات:
- إضافة جدران حماية لمنع هجمات DDoS.

---

### 8. ثغرة XSS - Cross Site Scripting

#### التفاصيل:
- تسمح بحقن أكواد JavaScript وHTML، مما يؤدي إلى سرقة ملفات تعريف الارتباط.
- استغلال عبر [إضافة المقالات](https://blog.spacetoon.com/usercp/artical/add).

#### التوصيات:
- منع إدخال أكواد JavaScript ضارة.

---

### 9. ثغرة Path Traversal في Laravel

#### التفاصيل:
- الكشف عن مسارات حساسة مثل etc/passwd.

#### التوصيات:
- إخفاء الأخطاء وعدم عرض تفاصيل النظام.

---

### 10. ثغرة Brute Force

#### الرابط:
- [لوحة المدير](https://conan27.spacetoon.com/admin/login)

#### التوصيات:
- تحديد عدد المحاولات وتطبيق فترة انتظار.

---

### 11. نقص في Headers الأمنية

#### المواقع المتأثرة:
- [spacetoon.com](https://spacetoon.com)
- [mail.spacetoon.com](https://mail.spacetoon.com)

#### التوصيات:
- إضافة Headers مثل: Content-Security-Policy, X-Frame-Options.

---

### 12. ثغرات XML-RPC في WordPress

#### الموقع:
- [22.spacetoon.com/xmlrpc.php](https://22.spacetoon.com/xmlrpc.php)

#### التوصيات:
- تعطيل XML-RPC إذا لم يكن ضروريًا.

---

### 13. الأخطاء في الكوكيز

#### التفاصيل:
- الكوكيز غير محمية بخاصية Secure وHttpOnly.

#### التوصيات:
- تفعيل الخصائص لحماية البيانات.

---

## الخاتمة

يجب اتخاذ إجراءات فورية لحل الثغرات وضمان أمان المستخدمين. أتمنى أن يكون التقرير مفيدًا وشكرًا لكم.
