# تقرير شامل عن الأخطاء والثغرات الأمنية في المواقع

## المقدمة

السلام عليكم ورحمة الله وبركاته،

أنا شاهين أمجد، عمري 16 عامًا. لقد فكرت في تقديم هدية بسيطة جدًا لكم تقديرًا للذكريات والعبر الجميلة التي قدمتموها لنا. حتى في عمري هذا، لا زلت أحن للمسلسلات الكرتونية والأنمي القديم مثل "القناص" في جزئه الأول.

الهدية التي أقدمها هي عبارة عن فصل شامل قمت به بكل مهاراتي لفحص مواقعكم على الإنترنت كوسيلة شكر لكم ولحماية مواقعكم من الهجمات التي يمكن أن تسبب ضررًا كبيرًا.

### الملاحظات
منذ الصغر كان هذا حلمي وقد تحقق بفضل الله. التالي هو تقرير شامل عن كل ما فحصته والثغرات التي وجدتها. أتمنى أن أكون قد شرحت بطريقة واضحة ومفهومة لكم. ❤️

---

## الثغرات المكتشفة

### 1. ملفات أرشفت في webarchive.org

#### الوصف:
تم العثور على ملفات تحتوي على سكربت PHP ضار يُعرف بـ "c99shell" كانت موجودة في الموقع الأساسي spacetoon.com. هذه الملفات تتيح للمخترق التحكم الكامل بالموقع وقواعد البيانات.

#### التأثير:
قد تُعرّض هذه الملفات الموقع لخطر الاختراق الكامل من قِبل المهاجمين، مما يؤدي إلى فقدان البيانات والسيطرة على الخادم.

#### الحلول:
- مراجعة ملفات النسخ الاحتياطي القديمة.
- التأكد من عدم وجود أي مسارات مشابهة مخفية.
- تفعيل نظام مراقبة الملفات لاكتشاف أي نشاط مشبوه.

---

### 2. خطأ تسجيل الدخول باستخدام OAuth

#### الوصف:
عند محاولة تسجيل الدخول باستخدام حسابات Google أو Facebook، يحدث خطأ "400" يمنع العملية.

#### التأثير:
يعطل تجربة المستخدم وقد يمنع التسجيل والدخول عبر هذه الخدمات بشكل دائم.

#### الحلول:
- مراجعة إعدادات OAuth.
- التحقق من صلاحيات تطبيقات الطرف الثالث.
- إعلام المستخدمين عند إصلاح الخطأ.

---

### 3. ثغرة Clickjacking

#### الوصف:
ثغرة تجعل المستخدم يضغط على أزرار مخفية داخل الموقع دون علمه.

#### التأثير:
يمكن استغلالها لتسجيل خروج المستخدمين أو تنفيذ أفعال غير مقصودة.

#### الحلول:
- تطبيق رأس X-Frame-Options لمنع تحميل الصفحات داخل إطارات.
- مراجعة الصفحات التي تحتوي على أزرار حساسة مثل حذف الحساب.

---

### 4. ثغرة File Upload

#### الوصف:
تمكين رفع ملفات ضارة مثل .html و.php عبر صفحة [إضافة المقالات](https://blog.spacetoon.com/usercp/artical/add).

#### التأثير:
يُتيح للمهاجمين التحكم الكامل بالخادم ورفع سكربتات ضارة.

#### الحلول:
- تقييد أنواع الملفات المسموح بها (مثل الصور فقط).
- استخدام فحص أمني لجميع الملفات المرفوعة.

---

### 5. ثغرة تسجيل الخروج

#### الوصف:
الرابط [تسجيل الخروج](https://blog.spacetoon.com/logout) يُمكن استغلاله لإجبار المستخدمين على الخروج دون علمهم.

#### التأثير:
يمكن استغلالها في هجمات تصيد عن طريق إرسال الروابط إلى المستخدمين.

#### الحلول:
- إضافة تأكيد قبل تنفيذ عملية تسجيل الخروج.

---

### 6. خطأ استعادة الحساب

#### الوصف:
فشل عملية استعادة كلمة المرور بدون أسباب واضحة.

#### التأثير:
يؤدي إلى فقدان المستخدمين إمكانية استعادة حساباتهم.

#### الحلول:
- مراجعة سجلات الخادم للتحقق من الأخطاء.
- تحسين رسائل الخطأ للمستخدمين.

---

### 7. عدم وجود WAF (جدار حماية للتطبيقات)

#### الموقع المتأثر:
- [moshayafamily.spacetoon.com](https://moshayafamily.spacetoon.com)

#### الوصف:
الموقع يفتقر إلى جدار حماية تطبيقات (WAF).

#### التأثير:
يزيد من خطر الهجمات مثل SQL Injection وXSS.

#### الحلول:
- تركيب واستخدام WAF لحماية الموقع من التهديدات.

---

### 8. ثغرة XSS - Cross Site Scripting

#### الوصف:
ثغرة تسمح بحقن أكواد JavaScript وHTML ضارة.

#### التأثير:
يمكن استخدامها لسرقة ملفات تعريف الارتباط (Cookies) أو تنفيذ إجراءات غير مرغوبة.

#### الحلول:
- ترميز المدخلات والمخرجات.
- استخدام مكتبات حماية ضد XSS.

---

### 9. ثغرة Path Traversal في Laravel

#### الوصف:
اكتشاف مسارات حساسة مثل etc/passwd عبر خطأ في معالجة الطلبات.

#### التأثير:
يمكن أن يُسرب معلومات حساسة عن النظام والبنية التحتية.

#### الحلول:
- تحسين معالجة الأخطاء في Laravel.
- إخفاء مسارات الخادم الحساسة.

---

### 10. ثغرة Brute Force

#### الوصف:
عدم وجود قيود على عدد محاولات تسجيل الدخول.

#### التأثير:
يمكن للمهاجمين تجربة كلمات مرور عديدة في وقت قصير.

#### الحلول:
- تحديد عدد المحاولات.
- تطبيق فترات انتظار بعد عدد محاولات فاشلة.

---

### 11. نقص في Headers الأمنية

#### الوصف:
عدم وجود رؤوس HTTP أساسية مثل Content-Security-Policy.

#### التأثير:
يزيد من خطر الهجمات مثل Clickjacking وXSS.

#### الحلول:
- إضافة رؤوس HTTP الأمنية مثل X-Content-Type-Options, Strict-Transport-Security.

---

### 12. ثغرات XML-RPC في WordPress

#### الوصف:
وجود ملفات XML-RPC مكشوفة قد تؤدي إلى هجمات قوة عمياء (Brute Force) أو DDoS.

#### التأثير:
تعرض الموقع لاستهلاك الموارد وتعطل الخدمة.

#### الحلول:
- تعطيل XML-RPC إذا لم يكن ضروريًا.
- استخدام إضافات WordPress لتعزيز الأمان.

---

### 13. الأخطاء في الكوكيز

#### الوصف:
الكوكيز غير محمية بخواص Secure وHttpOnly.

#### التأثير:
قد يؤدي إلى سرقة البيانات عند اعتراضها.

#### الحلول:
- تفعيل خواص Secure وHttpOnly على جميع الكوكيز الحساسة.

---

## الخاتمة

يجب اتخاذ إجراءات فورية لحل الثغرات وضمان أمان المستخدمين. أتمنى أن يكون التقرير مفيدًا وشكرًا لكم.
